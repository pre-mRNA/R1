# RNA Overlap-guided unified explanation
Classification of long-read RNA splicing and transcriptional status from long reads

# Overview
ROGUE1 classifies the transcriptional and splicing status of long RNA reads, generated by nanopore or pacbio RNA/cDNA sequencing. 

# File Structure
```
r1.py                         # ROGUE1 master script
read_classifier/
├── bam_to_bed.py             # Module to convert BAM to BED and process alignments
├── gtf_to_bed.py             # Module for converting GTF files to BED files
├── parse_output.py           # Script to parse output files and summarize data
├── process_genome.py         # Utilities to generate and process genome-related files
├── run_bedtools.py           # Main script to run BEDTools operations
└── utilities/
    ├── logging_config.py     # Configuration for logging across scripts
    └── run_command.py        # Utility to run shell commands
color_bam/
    └── color_bam_from_lis.py # Set alignment YC color bam tag from list of read IDs 
```

# Dependencies

### TODO: update dependencies 
```
Python 3.8 or higher
Pandas
Pysam
NumPy
BEDTools
Samtools
```

# Input Data:

### TODO: update input data requirements
BAM File: Prepare a BAM file containing RNA sequencing reads.
GTF File: A GTF file containing gene annotations.

# Usage: 

### TODO: update usage
Run the main script run_bedtools.py with the necessary arguments:

```
python r1.py --bam_file path/to/bamfile.bam --gtf_file path/to/annotations.gtf --output_dir path/to/output_table.txt
```

# Output:

### TODO: update outputs 

The program will output several BED files representing the intersections of reads with genomic features such as exons, genes, and regions downstream of genes (DOG).
Additional outputs include summarized classifications of reads based on their biotypes and structural annotations.

Post-Processing:
Use parse_output.py to further analyze and visualize the data:

## Setting Color Tags in BAM Files

To set color tags for specific reads in a BAM file, use the `bam_set_color.py` script. This utility requires a list of read IDs and the RGB color code that will be applied as a tag to these reads.

### Command

This command sets the RGB color `255,0,0` (red) to all reads listed in the `read_ids.txt` file. The changes are written to a new BAM file specified by the output path.

### For bam_set_color.py

- **Input BAM File**: A BAM file containing RNA sequencing reads.
- **Read IDs File**: A plain text file where each line contains a single read ID that corresponds to those found in the BAM file.
- **RGB Color**: The RGB color code in the format "R,G,B" where R, G, and B are integers between 0 and 255.

- It's important to ensure that the RGB values are correct and that the read IDs exist in the input BAM file to avoid processing errors.
- The script does not alter other tags or data within the BAM file except for adding or updating the `YC` tag for specified reads.


# Notes
- Ensure that the output directory has adequate space as genomic data can be quite large.
- The program is optimized for performance on systems with multiple CPUs and substantial RAM. Adjust the number of threads and buffer sizes in the scripts according to your system's capabilities.
